{% extends "base.html" %}
{% import "_macros.html" as macros %}

{% block content %}
<div class="page-header">
	<h1>Hello, {{ "{}".format(current_user.name) if  current_user.is_authenticated else "Stranger"}}</h1>
</div>
<div>
	{% if current_user.can(Permission.WRITE) %}
	<form action="" method="POST">
		{{ form.hidden_tag() }}
		<fieldset class="form-group">
			{{ macros.render_form(form.body) }}
			<div class="form-group mt-4">
				{{ form.submit(class="btn btn-outline-info") }}
			</div>
		</fieldset>
	</form>
	{% endif %}
</div>
<ul class="posts">
	{% for post in posts %}
	<li class="post">
		<div class="post-thumbnail">
			<a href="{{ url_for('.user', username=post.author.username) }}">
			<img class="img-rounded profile-thumbnail" src="{{ post.author.gravatar(size=40) }}">
			</a>
		</div>
		<div class="post-content">
			<div class="post-date">{{ moment(post.timestamp).fromNow() }}</div>
			<div class="post-author"><a href="{{ url_for('.user', username=post.author.username) }}">{{ post.author.username }}</a></div>
			<div class="post-body">{{ post.body }}</div>
		</div>
	</li>
	{% endfor %}
</ul>
{% endblock %}